# EcomBot - Чат-бот поддержки для интернет-магазина Shoply

Консольный чат-бот для поддержки клиентов интернет-магазина Shoply с интеграцией OpenAI API.

## Функциональность

- Ведение диалога с сохранением истории (до 3 реплик подряд)
- Ответы на типовые вопросы из внутренней базы FAQ
- Проверка статуса заказа по команде `/order <номер_заказа>`
- Логирование всех сессий в формате JSONL с учетом использованных токенов
- Интеграция с OpenAI API (по умолчанию используется модель gpt-4o-mini)

## Структура проекта

```
ecom-bot/
├── app.py                 # Основной файл приложения
├── requirements.txt       # Зависимости проекта
├── .env.example          # Пример файла с переменными окружения
├── README.md             # Документация
├── data/
│   ├── faq.json          # База часто задаваемых вопросов
│   └── orders.json       # Данные о заказах (для демонстрации)
└── logs/                 # Директория для логов (создается автоматически)
```

## Установка и настройка

1. Клонируйте репозиторий:
   ```
   git clone <url>
   cd ecom-bot
   ```

2. Установите зависимости:
   ```
   pip install -r requirements.txt
   ```

3. Создайте файл `.env` на основе `.env.example`:
   ```
   cp .env.example .env
   ```
   
4. В файле `.env` укажите ваши данные:
   - `OPENAI_API_KEY` - ваш API ключ от OpenAI
   - `OPENAI_MODEL` - модель для использования (по умолчанию gpt-4o-mini)
   - `BRAND_NAME` - название вашего магазина

## Использование

Запустите бота командой:
```
python app.py
```

Во время диалога можно использовать команду:
- `/order <номер_заказа>` - для проверки статуса заказа

Для выхода из чата введите `выход` или нажмите `Ctrl+C`.

## Логирование

Все сессии автоматически логируются в директории `logs/` в формате JSONL. 
Каждый файл лога имеет имя в формате `session_YYYYMMDD_HHMMSS.jsonl`.

В лог записывается:
- Временная метка
- Сообщения пользователя и бота
- Статистика использования токенов (при обращении к LLM)

## FAQ

Бот использует внутреннюю базу часто задаваемых вопросов из файла `data/faq.json`.
При обработке запроса бот сначала ищет ответ в FAQ, и только если не находит - обращается к LLM.

## Заказы

Для демонстрации работы с заказами используется файл `data/orders.json`.
В реальном приложении эта информация должна поступать из базы данных или API системы управления заказами.

## Безопасность

Никогда не публикуйте свой файл `.env` с API ключами в репозитории.
Файл `.env` добавлен в `.gitignore` для предотвращения случайной публикации.