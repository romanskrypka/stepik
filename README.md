# E-commerce Support Bot with Brand Voice

Брендированный чат-бот для поддержки клиентов интернет-магазина с единым стилем ответов.

## Описание

Этот проект представляет собой улучшенную версию консольного чат-бота из Модуля 1, который теперь использует LangChain для реализации единого стиля ответов в соответствии с бренд-гайдом магазина.

## Функциональность

- Ответы в фирменной манере согласно стилевому гайду
- Поддержка FAQ и проверка статуса заказов
- Few-shot примеры для лучшего понимания стиля
- Структурированный вывод: answer, tone, actions
- Автоматическая оценка стиля (LLM-оценка + простые правила)
- Логирование всех взаимодействий

## Структура проекта

```
ecom-bot/
  app_lc.py                 # Основное приложение с брендированным ботом
  src/
    brand_chain.py          # Реализация цепочки LangChain
    style_eval.py           # Автооценка стиля
  data/
    style_guide.yaml        # Стилевой гайд бренда
    few_shots.jsonl         # Few-shot примеры
    eval_prompts.txt        # Тестовые промпты для оценки
    faq.json                # База знаний FAQ
    orders.json             # Данные о заказах
  reports/                  # Отчеты об оценке стиля
  .env.example              # Пример файла переменных окружения
  requirements.txt          # Зависимости
  README.md                 # Этот файл
```

## Установка

1. Убедитесь, что у вас установлен Python 3.8 или выше. Вы можете проверить это с помощью команды:
   ```
   python --version
   ```

2. Установите зависимости:
   ```
   pip install -r requirements.txt
   ```

3. Создайте файл переменных окружения:
   
   В Windows:
   ```
   copy .env.example .env
   ```
   
   В Unix-подобных системах:
   ```
   cp .env.example .env
   ```

4. Внесите необходимые изменения в файл `.env`:
   - OPENAI_API_KEY - ваш API ключ OpenAI
   - OPENAI_MODEL - модель OpenAI (по умолчанию gpt-4o-mini)
   - BRAND_NAME - название бренда (по умолчанию Shoply)

## Запуск

### Интерактивный режим
Запустите приложение с помощью команды:
```
python app_lc.py
```

После запуска вы можете взаимодействовать с ботом, задавая вопросы о заказах или FAQ.

### Демонстрационный режим
Для демонстрационного режима, который показывает предопределенные примеры взаимодействия, используйте:
```
python app_lc.py --demo
```

### Оценка стиля
Для оценки соответствия ответов бота стилевому гайду запустите:
```
python src/style_eval.py
```

После запуска скрипта оценки будет создан отчет `reports/style_eval.json`, содержащий результаты анализа стиля ответов бота.

## Архитектура

### Стилевой гайд
Все правила стиля находятся в файле `data/style_guide.yaml`, включая:
- Тон и персону бренда
- Максимальное количество предложений
- Использование пунктов
- Запрещенные элементы
- Обязательные элементы

### Few-shot примеры
Примеры корректных ответов в стиле бренда находятся в файле `data/few_shots.jsonl`.

### Цепочка LangChain
Реализация цепочки находится в файле `src/brand_chain.py` и включает:
- Создание промпта из системных правил, few-shot примеров и контекста
- Структурированный вывод через Pydantic-модель
- Интеграцию с FAQ и данными о заказах

## Оценка стиля

Скрипт автооценки `src/style_eval.py` проверяет:
- Простые правила (отсутствие эмодзи, восклицаний, ограничения по длине)
- LLM-оценку соответствия стилю бренда
- Формирует отчет в формате JSON

## Разработка

### Добавление новых правил стиля
1. Обновите файл `data/style_guide.yaml` с новыми правилами стиля
2. Добавьте соответствующие примеры в `data/few_shots.jsonl` для демонстрации новых правил
3. При необходимости обновите код в `src/brand_chain.py` для поддержки новых функций

### Добавление новых few-shot примеров
Добавьте новые примеры в файл `data/few_shots.jsonl` в формате JSON по одной записи на строку. Каждый пример должен демонстрировать правильный ответ в стиле бренда.

### Добавление новых тестовых промптов
Добавьте новые тестовые строки в файл `data/eval_prompts.txt` по одной на строку. Эти промпты будут использоваться для оценки качества ответов бота.

## Требования к системе

- Python 3.8 или выше
- Доступ к API OpenAI

## Лицензия

MIT